(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{mQS9:function(t,e,i){"use strict";i.r(e);var o=i("aceb"),s=i("tmjD"),n=i("3Pt+"),r=i("RS3s"),a=i("vTDv"),c=i("tyNb"),b=i("fXoL");let l=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=b.Lb({type:t,selectors:[["alunos"]],decls:1,vars:0,template:function(t,e){1&t&&b.Sb(0,"router-outlet")},directives:[c.h],encapsulation:2}),t})();var u=i("Mw0X"),d=i("nYR2"),m=i("PSD3"),h=i.n(m),p=i("FIB3"),f=i("UXd6");let g=(()=>{class t{constructor(t,e,i){this.InstituicaoService=t,this.UsuarioService=e,this.router=i,this.settingsDefault={hideSubHeader:!0,actions:{position:"right",columnTitle:"A\xe7\xf5es",add:!1,edit:!1,delete:!1,custom:[{name:"edit",title:'<i class="nb-edit"></i>'}]},add:{addButtonContent:'<i class="nb-plus"></i>',createButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>'},edit:{editButtonContent:'<i class="nb-edit"></i>',saveButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>',confirmSave:!0},delete:{deleteButtonContent:'<i class="nb-trash"></i>',confirmDelete:!0},columns:{nome:{title:"Nome",type:"string",editable:!0},email:{title:"E-mail",type:"string",editable:!1},validated:{title:"Validado",type:"custom",renderComponent:f.a},turmas:{title:"Turma",type:"string",editable:!1,valuePrepareFunction:t=>t.length>0?t[0].nome:""}}},this.settings1=Object.assign(Object.assign({},this.settingsDefault),{actions:Object.assign(Object.assign({},this.settingsDefault.actions),{custom:[...this.settingsDefault.actions.custom,{name:"status",title:'<i class="nb-trash" title="Desativar usu\xe1rio"></i>'}]})}),this.settings2=Object.assign(Object.assign({},this.settingsDefault),{actions:Object.assign(Object.assign({},this.settingsDefault.actions),{custom:[...this.settingsDefault.actions.custom,{name:"status",title:'<i class="nb-loop" title="Ativar usu\xe1rio"></i>'}]})}),this.source=new r.a,this.source2=new r.a,this.getAlunos()}getAlunos(){this.InstituicaoService.getAlunos().pipe(Object(d.a)(()=>{})).subscribe(t=>{const e=t.filter(t=>t.isAtivo),i=t.filter(t=>!t.isAtivo);this.source.load(e),this.source2.load(i),this.source.refresh(),this.source2.refresh()})}onSearch(t=""){""!=t?this.source.setFilter([{field:"id",search:t},{field:"name",search:t},{field:"cpf",search:t},{field:"turma",search:t},{field:"onboardStatus",search:t}],!1):this.source.reset()}onDeleteConfirm(t,e){if(window.confirm("Tem certeza que deseja "+(t.data.isAtivo?"desativar":"ativar")+" este usu\xe1rio?")){let i="";"source1"==e?i="desativado":"source2"==e&&(i="ativado"),this.UsuarioService.deleteUser({id:t.data.id,status:!t.data.isAtivo}).pipe(Object(d.a)(()=>{})).subscribe(e=>{h.a.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}).fire({icon:"success",title:"O usu\xe1rio "+t.data.nome+" "+i+" com sucesso"}),this.getAlunos()})}}onCustomAction(t,e){"status"==t.action?this.onDeleteConfirm(t,e):"edit"==t.action&&this.router.navigateByUrl("/instituicao/usuarios/alunos/editar/"+t.data.id)}}return t.\u0275fac=function(e){return new(e||t)(b.Rb(u.a),b.Rb(p.a),b.Rb(c.c))},t.\u0275cmp=b.Lb({type:t,selectors:[["alunos"]],decls:15,vars:4,consts:[[1,"row"],[1,"col-md-5"],[1,"col-md-5","ml-auto","text-right"],["nbInput","","type","text","placeholder","Search...",1,"search",3,"keydown.enter"],["search",""],["tabTitle","Ativos"],[3,"settings","source","custom"],["tabTitle","Inativos"]],template:function(t,e){if(1&t){const t=b.Yb();b.Xb(0,"nb-card"),b.Xb(1,"nb-card-header"),b.Xb(2,"div",0),b.Xb(3,"div",1),b.Xb(4,"h4"),b.Gc(5,"Alunos"),b.Wb(),b.Wb(),b.Xb(6,"div",2),b.Xb(7,"input",3,4),b.fc("keydown.enter",(function(){b.wc(t);const i=b.uc(8);return e.onSearch(i.value)})),b.Wb(),b.Wb(),b.Wb(),b.Wb(),b.Xb(9,"nb-card-body"),b.Xb(10,"nb-tabset"),b.Xb(11,"nb-tab",5),b.Xb(12,"ng2-smart-table",6),b.fc("custom",(function(t){return e.onCustomAction(t,"source1")})),b.Wb(),b.Wb(),b.Xb(13,"nb-tab",7),b.Xb(14,"ng2-smart-table",6),b.fc("custom",(function(t){return e.onCustomAction(t,"source2")})),b.Wb(),b.Wb(),b.Wb(),b.Wb(),b.Wb()}2&t&&(b.Eb(12),b.nc("settings",e.settings1)("source",e.source),b.Eb(2),b.nc("settings",e.settings2)("source",e.source2))},directives:[o.x,o.z,o.L,o.w,o.pb,o.ob,r.b],styles:["[_nghost-%COMP%]   nb-tab[_ngcontent-%COMP%]{padding-left:0;padding-right:0}"]}),t})();var v=i("ofXK");function W(t,e){1&t&&(b.Xb(0,"div",6),b.Gc(1,"Voc\xea precisa cadastrar uma "),b.Xb(2,"a",22),b.Gc(3,"turma"),b.Wb(),b.Wb())}function X(t,e){if(1&t&&(b.Xb(0,"nb-option",25),b.Gc(1),b.Wb()),2&t){const t=e.$implicit;b.nc("value",t.id),b.Eb(1),b.Ic(" ",t.nome,"")}}function S(t,e){if(1&t){const t=b.Yb();b.Xb(0,"div",6),b.Xb(1,"nb-select",23),b.fc("selectedChange",(function(e){return b.wc(t),b.hc().selectedItem=e})),b.Ec(2,X,2,2,"nb-option",24),b.Wb(),b.Wb()}if(2&t){const t=b.hc();b.Eb(1),b.nc("selected",t.selectedItem),b.Eb(1),b.nc("ngForOf",t.turmas)}}function A(t,e){if(1&t&&(b.Xb(0,"nb-option",22),b.Gc(1),b.Wb()),2&t){const t=e.$implicit;b.nc("value",t.id),b.Eb(1),b.Ic(" ",t.nome,"")}}function C(t,e){if(1&t){const t=b.Yb();b.Xb(0,"nb-card-body"),b.Xb(1,"form",4),b.fc("ngSubmit",(function(){return b.wc(t),b.hc().submit()})),b.Xb(2,"div",5),b.Xb(3,"label",6),b.Gc(4,"Nome"),b.Wb(),b.Xb(5,"div",7),b.Sb(6,"input",8),b.Wb(),b.Wb(),b.Xb(7,"div",5),b.Xb(8,"label",9),b.Gc(9,"Turma"),b.Wb(),b.Xb(10,"div",7),b.Xb(11,"nb-select",10),b.fc("selectedChange",(function(e){return b.wc(t),b.hc().turmaChange(e)})),b.Ec(12,A,2,2,"nb-option",11),b.Wb(),b.Wb(),b.Wb(),b.Xb(13,"div",5),b.Xb(14,"label",12),b.Gc(15,"CPF"),b.Wb(),b.Xb(16,"div",7),b.Sb(17,"input",13),b.Wb(),b.Wb(),b.Xb(18,"div",5),b.Xb(19,"label",14),b.Gc(20,"E-mail"),b.Wb(),b.Xb(21,"div",7),b.Sb(22,"input",15),b.Wb(),b.Wb(),b.Xb(23,"div",16),b.Xb(24,"label",17),b.Gc(25,"Telefone para Contato"),b.Wb(),b.Xb(26,"div",7),b.Sb(27,"input",18),b.Sb(28,"input",19),b.Wb(),b.Wb(),b.Xb(29,"div",5),b.Xb(30,"div",20),b.Xb(31,"button",21),b.Gc(32,"Atualizar"),b.Wb(),b.Wb(),b.Wb(),b.Wb(),b.Wb()}if(2&t){const t=b.hc();b.Eb(1),b.nc("formGroup",t.form),b.Eb(11),b.nc("ngForOf",t.turmas),b.Eb(11),b.nc("formGroup",t.phones),b.Eb(8),b.nc("disabled",t.form.invalid||t.isLoading)}}const y=[{path:"",component:l,children:[{path:"",redirectTo:"listar",pathMatch:"full"},{path:"listar",component:g},{path:"adicionar",component:(()=>{class t{constructor(t,e,i){this.formBuilder=t,this.InstituicaoService=e,this.router=i,this.isLoading=!0,this.turmas=[],this.ngrupo=[],this.idgrupo=[],this.phonelist=[]}ngOnInit(){this.getTurmas(),this.createForm()}getTurmas(){this.InstituicaoService.getTurmas().subscribe(t=>{this.isLoading=!1,t.forEach(t=>{t.series.forEach(t=>{t.turmas.forEach(t=>{this.turmas.push(t)})})})})}get phones(){return this.form.get("phones")}createForm(){this.form=this.formBuilder.group({nome:["",n.A.required],perfil:["Aluno"],turma:["",n.A.required],email:["",[n.A.required,n.A.email]],cpf:["",[n.A.required,n.A.minLength(11),n.A.maxLength(11)]],dataNascimento:["",n.A.required],phones:this.formBuilder.group({ddd:["",n.A.required],phoneNumber:["",n.A.required]})})}Adicionar(){this.isLoading=!0;const t=Object.assign({},this.form.value);this.InstituicaoService.inserirAluno(t).pipe(Object(d.a)(()=>{this.isLoading=!1})).subscribe(t=>{this.isLoading=!1,t&&(h.a.fire("Ok","Aluno adicionada com sucesso","success"),this.router.navigateByUrl("/instituicao/usuarios/alunos"))})}}return t.\u0275fac=function(e){return new(e||t)(b.Rb(n.d),b.Rb(u.a),b.Rb(c.c))},t.\u0275cmp=b.Lb({type:t,selectors:[["alunos-adicionar"]],decls:43,vars:6,consts:[["nbSpinnerStatus","primary","nbSpinnerSize","large","nbSpinnerMessage","",3,"nbSpinner"],[1,"row"],[1,"col-md-5"],["action","",3,"formGroup"],[1,"form-group","row"],["for","nome",1,"label","col-sm-2","col-form-label"],[1,"col-sm-10"],["type","text","nbInput","","fullWidth","","id","nome","placeholder","Nome","formControlName","nome"],["for","turma",1,"label","col-sm-2","col-form-label"],["class","col-sm-10",4,"ngIf"],["for","cpf",1,"label","col-sm-2","col-form-label"],["type","text","nbInput","","fullWidth","","id","cpf","placeholder","CPF","formControlName","cpf","mask","000.000.000-00"],["for","email",1,"label","col-sm-2","col-form-label"],["type","email","nbInput","","fullWidth","","id","email","placeholder","E-mail","formControlName","email"],["for","dataNascimento",1,"label","col-sm-2","col-form-label"],["type","text","nbInput","","fullWidth","","id","dataNascimento","placeholder","Data de Nascimento","formControlName","dataNascimento","mask","00/00/0000"],[1,"form-group","row",3,"formGroup"],["for","phone",1,"label","col-sm-2","col-form-label"],["type","text","nbInput","","id","ddd","placeholder","(00)","formControlName","ddd","mask","(00)"],["type","text","nbInput","","id","phoneNumber","placeholder","0.0000-0000","formControlName","phoneNumber","mask","0.0000-0000"],[1,"offset-sm-2","col-sm-10"],["type","submit","nbButton","","status","primary",3,"disabled","click"],["routerLink","/instituicao/turmas/cadastrar"],["fullWidth","","id","turma","placeholder","Selecione uma Turma","formControlName","turma",3,"selected","selectedChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,e){1&t&&(b.Xb(0,"nb-card",0),b.Xb(1,"nb-card-header"),b.Xb(2,"div",1),b.Xb(3,"div",2),b.Xb(4,"h4"),b.Gc(5,"Adicionar Aluno"),b.Wb(),b.Wb(),b.Wb(),b.Wb(),b.Xb(6,"nb-card-body"),b.Xb(7,"form",3),b.Xb(8,"div",4),b.Xb(9,"label",5),b.Gc(10,"Nome"),b.Wb(),b.Xb(11,"div",6),b.Sb(12,"input",7),b.Wb(),b.Wb(),b.Xb(13,"div",4),b.Xb(14,"label",8),b.Gc(15,"Turma"),b.Wb(),b.Ec(16,W,4,0,"div",9),b.Ec(17,S,3,2,"div",9),b.Wb(),b.Xb(18,"div",4),b.Xb(19,"label",10),b.Gc(20,"CPF"),b.Wb(),b.Xb(21,"div",6),b.Sb(22,"input",11),b.Wb(),b.Wb(),b.Xb(23,"div",4),b.Xb(24,"label",12),b.Gc(25,"E-mail"),b.Wb(),b.Xb(26,"div",6),b.Sb(27,"input",13),b.Wb(),b.Wb(),b.Xb(28,"div",4),b.Xb(29,"label",14),b.Gc(30,"Data de Nascimento"),b.Wb(),b.Xb(31,"div",6),b.Sb(32,"input",15),b.Wb(),b.Wb(),b.Xb(33,"div",16),b.Xb(34,"label",17),b.Gc(35,"Telefone para Contato"),b.Wb(),b.Xb(36,"div",6),b.Sb(37,"input",18),b.Sb(38,"input",19),b.Wb(),b.Wb(),b.Xb(39,"div",4),b.Xb(40,"div",20),b.Xb(41,"button",21),b.fc("click",(function(){return e.Adicionar()})),b.Gc(42,"Adicionar"),b.Wb(),b.Wb(),b.Wb(),b.Wb(),b.Wb(),b.Wb()),2&t&&(b.nc("nbSpinner",e.isLoading),b.Eb(7),b.nc("formGroup",e.form),b.Eb(9),b.nc("ngIf",0==e.turmas.length),b.Eb(1),b.nc("ngIf",e.turmas&&e.turmas.length>0),b.Eb(16),b.nc("formGroup",e.phones),b.Eb(8),b.nc("disabled",e.form.invalid||e.isLoading))},directives:[o.x,o.lb,o.z,o.w,n.C,n.q,n.h,o.L,n.b,n.p,n.g,v.m,s.a,o.s,c.f,o.gb,v.l,o.bb],styles:[""]}),t})()},{path:"editar/:id",component:(()=>{class t{constructor(t,e,i,o){this.route=t,this.formBuilder=e,this.InstituicaoService=i,this.router=o,this.isLoading=!0,this.turmas=[],this.aluno={},this.inserirAlunoTurma=!1}ngOnInit(){this.getTurmas(),this.route.paramMap.subscribe(t=>{this.id=t.get("id"),this.createForm()})}getTurmas(){this.InstituicaoService.getTurmas().subscribe(t=>{t.forEach(t=>{t.series.forEach(t=>{t.turmas.forEach(t=>{this.turmas.push(t)})})})})}get phones(){return this.form.get("phones")}turmaChange(t){this.inserirAlunoTurma=!0}createForm(){this.InstituicaoService.getUserId(this.id).subscribe(t=>{this.isLoading=!1,this.aluno=t;let e=this.aluno;this.form=this.formBuilder.group({id:[e.id],nome:[e.nome,n.A.required],perfil:["Aluno"],turma:[e.turmas[0]?e.turmas[0].id:""],email:[e.email,n.A.required],cpf:[e.cpf,n.A.required],phones:this.formBuilder.group({ddd:[e.phones[0]?e.phones[0].ddd:"",n.A.required],phoneNumber:[e.phones[0]?e.phones[0].phoneNumber:"",n.A.required]})})})}submit(){this.isLoading=!0;const t=Object.assign({},this.form.value);this.InstituicaoService.editarAluno(t).pipe(Object(d.a)(()=>{this.isLoading=!1})).subscribe(t=>{if(this.inserirAlunoTurma)return this.inserirAlunoNaTurma(),!1;this.isLoading=!1,t&&this.msgSuccesso()})}inserirAlunoNaTurma(){this.isLoading=!0;const t=Object.assign({},this.form.value);this.InstituicaoService.inserirAlunoNaTurma(t).pipe(Object(d.a)(()=>{this.isLoading=!1})).subscribe(t=>{this.isLoading=!1,t&&this.msgSuccesso()})}msgSuccesso(){h.a.fire("Ok","Aluno atualizado com sucesso","success"),this.router.navigateByUrl("/instituicao/usuarios/alunos")}}return t.\u0275fac=function(e){return new(e||t)(b.Rb(c.a),b.Rb(n.d),b.Rb(u.a),b.Rb(c.c))},t.\u0275cmp=b.Lb({type:t,selectors:[["alunos-editar"]],decls:7,vars:2,consts:[["nbSpinnerStatus","primary","nbSpinnerSize","large","nbSpinnerMessage","",3,"nbSpinner"],[1,"row"],[1,"col-md-5"],[4,"ngIf"],["action","",3,"formGroup","ngSubmit"],[1,"form-group","row"],["for","nome",1,"label","col-sm-2","col-form-label"],[1,"col-sm-10"],["type","text","nbInput","","fullWidth","","id","nome","placeholder","Nome","formControlName","nome"],["for","turma",1,"label","col-sm-2","col-form-label"],["fullWidth","","id","turma","placeholder","Selecione uma Turma","formControlName","turma",3,"selectedChange"],[3,"value",4,"ngFor","ngForOf"],["for","cpf",1,"label","col-sm-2","col-form-label"],["type","text","nbInput","","fullWidth","","id","cpf","placeholder","CPF","formControlName","cpf","mask","000.000.000-00"],["for","email",1,"label","col-sm-2","col-form-label"],["type","email","nbInput","","fullWidth","","id","email","placeholder","E-mail","formControlName","email"],[1,"form-group","row",3,"formGroup"],["for","phone",1,"label","col-sm-2","col-form-label"],["type","text","nbInput","","id","ddd","placeholder","(00)","formControlName","ddd","mask","(00)"],["type","text","nbInput","","id","phoneNumber","placeholder","0.0000-0000","formControlName","phoneNumber","mask","0.0000-0000"],[1,"offset-sm-2","col-sm-10"],["type","submit","nbButton","","status","primary",3,"disabled"],[3,"value"]],template:function(t,e){1&t&&(b.Xb(0,"nb-card",0),b.Xb(1,"nb-card-header"),b.Xb(2,"div",1),b.Xb(3,"div",2),b.Xb(4,"h4"),b.Gc(5,"Editar dados do Aluno"),b.Wb(),b.Wb(),b.Wb(),b.Wb(),b.Ec(6,C,33,4,"nb-card-body",3),b.Wb()),2&t&&(b.nc("nbSpinner",e.isLoading),b.Eb(6),b.nc("ngIf",e.form&&e.aluno))},directives:[o.x,o.lb,o.z,v.m,o.w,n.C,n.q,n.h,o.L,n.b,n.p,n.g,o.gb,v.l,s.a,o.s,o.bb],styles:[""]}),t})()}]}];let I=(()=>{class t{}return t.\u0275mod=b.Pb({type:t}),t.\u0275inj=b.Ob({factory:function(e){return new(e||t)},imports:[[c.g.forChild(y)],c.g]}),t})();i.d(e,"AlunosModule",(function(){return N}));let N=(()=>{class t{}return t.\u0275mod=b.Pb({type:t}),t.\u0275inj=b.Ob({factory:function(e){return new(e||t)},imports:[[o.A,o.vb,o.K,o.M,o.n,o.D,o.G,o.eb,o.hb,o.xb,a.a,o.t,I,r.c,n.x,s.b,o.mb,o.qb]]}),t})()}}]);