(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{ypFQ:function(i,e,t){"use strict";t.r(e);var s=t("aceb"),o=t("tmjD"),n=t("3Pt+"),r=t("RS3s"),c=t("vTDv"),a=t("tyNb"),l=t("fXoL");let b=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=l.Lb({type:i,selectors:[["professores"]],decls:1,vars:0,template:function(i,e){1&i&&l.Sb(0,"router-outlet")},directives:[a.h],encapsulation:2}),i})();var u=t("Mw0X"),d=t("nYR2"),f=t("FIB3"),m=t("PSD3"),p=t.n(m);let h=(()=>{class i{constructor(i,e,t){this.InstituicaoService=i,this.UsuarioService=e,this.router=t,this.settingsDefault={hideSubHeader:!0,noDataMessage:"N\xe3o h\xe1 nenhum dado para exibir",actions:{add:!1,position:"right",columnTitle:"A\xe7\xf5es",edit:!1,delete:!1,custom:[{name:"edit",title:'<i class="nb-edit"></i>'}]},add:{addButtonContent:'<i class="nb-plus"></i>',createButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>'},edit:{editButtonContent:'<i class="nb-edit"></i>',saveButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>',confirmSave:!0},delete:{deleteButtonContent:'<i class="nb-trash"></i>',confirmDelete:!0},columns:{nome:{title:"Nome",type:"string",editable:!0},perfil:{title:"Perfil",type:"string",editable:!1},cpf:{title:"CPF",type:"string",editable:!1},email:{title:"E-mail",type:"string",editable:!1}}},this.settings1=Object.assign(Object.assign({},this.settingsDefault),{actions:Object.assign(Object.assign({},this.settingsDefault.actions),{custom:[...this.settingsDefault.actions.custom,{name:"status",title:'<i class="nb-trash" title="Desativar usu\xe1rio"></i>'}]})}),this.settings2=Object.assign(Object.assign({},this.settingsDefault),{actions:Object.assign(Object.assign({},this.settingsDefault.actions),{custom:[...this.settingsDefault.actions.custom,{name:"status",title:'<i class="nb-loop" title="Ativar usu\xe1rio"></i>'}]})}),this.source=new r.a,this.source2=new r.a,this.getProfessores()}getProfessores(){this.InstituicaoService.getProfessores().pipe(Object(d.a)(()=>{})).subscribe(i=>{const e=i.filter(i=>i.isAtivo),t=i.filter(i=>!i.isAtivo);this.source.load(e),this.source2.load(t),this.source.refresh(),this.source2.refresh()})}onSearch(i=""){""!=i?this.source.setFilter([{field:"id",search:i},{field:"name",search:i},{field:"perfil",search:i},{field:"cpf",search:i}],!1):this.source.reset()}onDeleteConfirm(i,e){if(window.confirm("Tem certeza que deseja "+(i.data.isAtivo?"desativar":"ativar")+" este usu\xe1rio?")){let t="";"source1"==e?t="desativado":"source2"==e&&(t="ativado"),this.UsuarioService.deleteUser({id:i.data.id,status:!i.data.isAtivo}).pipe(Object(d.a)(()=>{})).subscribe(e=>{p.a.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}).fire({icon:"success",title:"O usu\xe1rio "+i.data.nome+" "+t+" com sucesso"}),this.getProfessores()})}}onCustomAction(i,e){"status"==i.action?this.onDeleteConfirm(i,e):"edit"==i.action&&this.router.navigateByUrl("/instituicao/usuarios/professores/adicionar/"+i.data.id)}}return i.\u0275fac=function(e){return new(e||i)(l.Rb(u.a),l.Rb(f.a),l.Rb(a.c))},i.\u0275cmp=l.Lb({type:i,selectors:[["professores-listar"]],decls:15,vars:4,consts:[[1,"row"],[1,"col-md-5"],[1,"col-md-5","ml-auto","text-right"],["nbInput","","type","text","placeholder","Buscar",1,"search",3,"keydown.enter"],["search",""],["tabTitle","Ativos"],[3,"settings","source","custom"],["tabTitle","Inativos"]],template:function(i,e){if(1&i){const i=l.Yb();l.Xb(0,"nb-card"),l.Xb(1,"nb-card-header"),l.Xb(2,"div",0),l.Xb(3,"div",1),l.Xb(4,"h4"),l.Gc(5,"Professores"),l.Wb(),l.Wb(),l.Xb(6,"div",2),l.Xb(7,"input",3,4),l.fc("keydown.enter",(function(){l.wc(i);const t=l.uc(8);return e.onSearch(t.value)})),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Xb(9,"nb-card-body"),l.Xb(10,"nb-tabset"),l.Xb(11,"nb-tab",5),l.Xb(12,"ng2-smart-table",6),l.fc("custom",(function(i){return e.onCustomAction(i,"source1")})),l.Wb(),l.Wb(),l.Xb(13,"nb-tab",7),l.Xb(14,"ng2-smart-table",6),l.fc("custom",(function(i){return e.onCustomAction(i,"source2")})),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Wb()}2&i&&(l.Eb(12),l.nc("settings",e.settings1)("source",e.source),l.Eb(2),l.nc("settings",e.settings2)("source",e.source2))},directives:[s.x,s.z,s.L,s.w,s.pb,s.ob,r.b],styles:["[_nghost-%COMP%]   nb-tab[_ngcontent-%COMP%]{padding-left:0;padding-right:0}"]}),i})();var g=t("ofXK");function v(i,e){1&i&&(l.Xb(0,"h4"),l.Gc(1,"Adicionar Professores e Coordenadores"),l.Wb())}function W(i,e){1&i&&(l.Xb(0,"h4"),l.Gc(1,"Editar Professor"),l.Wb())}function X(i,e){1&i&&(l.Xb(0,"nb-select",21),l.Xb(1,"nb-option",22),l.Gc(2,"Coordenador"),l.Wb(),l.Xb(3,"nb-option",23),l.Gc(4,"Professor"),l.Wb(),l.Wb())}function D(i,e){1&i&&(l.Xb(0,"nb-select",24),l.Xb(1,"nb-option",22),l.Gc(2,"Coordenador"),l.Wb(),l.Xb(3,"nb-option",23),l.Gc(4,"Professor"),l.Wb(),l.Wb())}function E(i,e){1&i&&(l.Xb(0,"div",8),l.Gc(1,"Voc\xea precisa cadastrar as "),l.Xb(2,"a",28),l.Gc(3,"turmas"),l.Wb(),l.Gc(4," e "),l.Xb(5,"a",29),l.Gc(6,"disciplinas"),l.Wb(),l.Gc(7," antes de cadastrar um Professor "),l.Wb())}function P(i,e){if(1&i&&(l.Xb(0,"nb-option",38),l.Gc(1),l.Wb()),2&i){const i=e.$implicit;l.nc("value",i.id),l.Eb(1),l.Ic(" ",i.nome," ")}}function y(i,e){if(1&i&&(l.Xb(0,"nb-option",38),l.Gc(1),l.Wb()),2&i){const i=e.$implicit;l.nc("value",i._id),l.Eb(1),l.Ic(" ",i.nome," ")}}function I(i,e){if(1&i){const i=l.Yb();l.Xb(0,"div",31),l.Xb(1,"div",8),l.Xb(2,"div",1),l.Xb(3,"nb-select",32),l.Ec(4,P,2,2,"nb-option",33),l.Wb(),l.Xb(5,"nb-select",34),l.Ec(6,y,2,2,"nb-option",33),l.Wb(),l.Wb(),l.Wb(),l.Xb(7,"div",35),l.Xb(8,"button",36),l.fc("click",(function(){l.wc(i);const t=e.index;return l.hc(4).deleteTurmasDisciplinas(t)})),l.Sb(9,"nb-icon",37),l.Wb(),l.Wb(),l.Wb()}if(2&i){const i=e.index,t=l.hc(4);l.nc("formGroupName",i),l.Eb(4),l.nc("ngForOf",t.turmas),l.Eb(2),l.nc("ngForOf",t.disciplinas)}}function S(i,e){if(1&i&&(l.Xb(0,"div",8),l.Ec(1,I,10,3,"div",30),l.Wb()),2&i){const i=l.hc(3);l.Eb(1),l.nc("ngForOf",i.turmasDisciplinas.controls)}}function w(i,e){if(1&i&&(l.Xb(0,"div",25),l.Xb(1,"label",26),l.Gc(2," Turmas e Disciplinas:"),l.Wb(),l.Ec(3,E,8,0,"div",27),l.Ec(4,S,2,1,"div",27),l.Wb()),2&i){const i=l.hc(2);l.Eb(3),l.nc("ngIf",0==i.turmas.length||0==i.disciplinas.length),l.Eb(1),l.nc("ngIf",i.turmas.length>0&&i.disciplinas.length>0)}}function C(i,e){if(1&i){const i=l.Yb();l.Xb(0,"div",39),l.Xb(1,"button",40),l.fc("click",(function(){return l.wc(i),l.hc(2).addTurmasDisciplinas()})),l.Sb(2,"nb-icon",41),l.Gc(3," Adicionar Turma e Disciplina "),l.Wb(),l.Wb()}if(2&i){const i=l.hc(2);l.Eb(1),l.nc("disabled","Professor"!=i.form.controls.perfil.value)}}function B(i,e){if(1&i){const i=l.Yb();l.Xb(0,"form",5),l.Xb(1,"div",6),l.Xb(2,"label",7),l.Gc(3,"Nome"),l.Wb(),l.Xb(4,"div",8),l.Sb(5,"input",9),l.Wb(),l.Wb(),l.Xb(6,"div",6),l.Xb(7,"label",10),l.Gc(8,"CPF"),l.Wb(),l.Xb(9,"div",8),l.Sb(10,"input",11),l.Wb(),l.Wb(),l.Xb(11,"div",6),l.Xb(12,"label",12),l.Gc(13,"E-mail"),l.Wb(),l.Xb(14,"div",8),l.Sb(15,"input",13),l.Wb(),l.Wb(),l.Xb(16,"div",6),l.Xb(17,"label",14),l.Gc(18,"Perfil"),l.Wb(),l.Xb(19,"div",8),l.Ec(20,X,5,0,"nb-select",15),l.Ec(21,D,5,0,"nb-select",16),l.Wb(),l.Wb(),l.Ec(22,w,5,2,"div",17),l.Xb(23,"div",6),l.Ec(24,C,4,1,"div",18),l.Xb(25,"div",19),l.Xb(26,"button",20),l.fc("click",(function(){return l.wc(i),l.hc().Adicionar()})),l.Gc(27),l.Wb(),l.Wb(),l.Wb(),l.Wb()}if(2&i){const i=l.hc();l.nc("formGroup",i.form),l.Eb(20),l.nc("ngIf",!i.id),l.Eb(1),l.nc("ngIf",i.id),l.Eb(1),l.nc("ngIf","Professor"==i.form.controls.perfil.value&&!i.id),l.Eb(2),l.nc("ngIf",i.turmas.length>0&&i.disciplinas.length>0&&!i.id),l.Eb(2),l.nc("disabled",i.form.invalid||i.isLoading),l.Eb(1),l.Hc(i.id?"Editar":"Adicionar")}}let O=(()=>{class i{constructor(i,e,t,s){this.route=i,this.formBuilder=e,this.InstituicaoService=t,this.router=s,this.isLoading=!0,this.turmas=[],this.disciplinas=[],this.route.paramMap.subscribe(i=>{this.id=i.get("id"),this.getDisciplinas(),this.getTurmas(),this.id?this.getProfessorDetails():this.createForm()})}ngOnInit(){}getTurmas(){this.InstituicaoService.getTurmas().pipe(Object(d.a)(()=>{})).subscribe(i=>{this.isLoading=!1,i.forEach(i=>{i.series.forEach(i=>{i.turmas.forEach(i=>{this.turmas.push(i)})})}),console.log(this.turmas)})}getDisciplinas(){this.InstituicaoService.getDisciplinas().pipe(Object(d.a)(()=>{})).subscribe(i=>{this.disciplinas=i})}get turmasDisciplinas(){return this.form.get("turmasDisciplinas")}addTurmasDisciplinas(i){console.log(i),this.turmasDisciplinas.push(this.formBuilder.group({turma:[i?i.id:"",n.B.required],disciplina:[i?i.disciplinas[0].idDisciplina:"",n.B.required]}))}deleteTurmasDisciplinas(i){this.turmasDisciplinas.removeAt(i)}getProfessorDetails(){this.InstituicaoService.getProfessorId(this.id).pipe(Object(d.a)(()=>{})).subscribe(i=>{this.isLoading=!1;let e=i;this.createForm(e),console.log(e),e&&e.turmasDoProfessor.forEach(i=>{this.addTurmasDisciplinas(i)})})}createForm(i){this.form=this.formBuilder.group({id:[i?i.id:""],nome:[i?i.nome:"",n.B.required],perfil:[i?i.perfil:"",n.B.required],email:[i?i.email:"",[n.B.required,n.B.email]],cpf:[i?i.cpf:"",[n.B.required,n.B.minLength(11),n.B.maxLength(11)]],turmasDisciplinas:this.formBuilder.array([])})}Adicionar(){this.isLoading=!0;const i=Object.assign({},this.form.value);console.log(i),this.id?this.InstituicaoService.editarProfessor(i).pipe(Object(d.a)(()=>{this.isLoading=!1})).subscribe(i=>{i&&(p.a.fire("Ok","Professor editado com sucesso","success"),this.router.navigateByUrl("/instituicao/usuarios/professores")),this.isLoading=!1}):this.InstituicaoService.inserirProfessor(i).pipe(Object(d.a)(()=>{this.isLoading=!1})).subscribe(i=>{this.isLoading=!1,i&&(p.a.fire("Ok","Professor adicionada com sucesso","success"),this.router.navigateByUrl("/instituicao/usuarios/professores"))})}inserirProfessorDisciplina(i){this.InstituicaoService.inserirProfessorDisciplina(i).pipe(Object(d.a)(()=>{this.isLoading=!1})).subscribe(i=>{console.log(i)})}}return i.\u0275fac=function(e){return new(e||i)(l.Rb(a.a),l.Rb(n.e),l.Rb(u.a),l.Rb(a.c))},i.\u0275cmp=l.Lb({type:i,selectors:[["professores-adicionar"]],decls:8,vars:4,consts:[["nbSpinnerStatus","primary","nbSpinnerSize","large","nbSpinnerMessage","",3,"nbSpinner"],[1,"row"],[1,"col-md-5"],[4,"ngIf"],["action","",3,"formGroup",4,"ngIf"],["action","",3,"formGroup"],[1,"form-group","row"],["for","nome",1,"label","col-sm-2","col-form-label"],[1,"col-sm-10"],["type","text","nbInput","","fullWidth","","id","nome","placeholder","Nome","formControlName","nome"],["for","cpf",1,"label","col-sm-2","col-form-label"],["type","text","nbInput","","fullWidth","","id","cpf","placeholder","CPF","formControlName","cpf","mask","000.000.000-00"],["for","email",1,"label","col-sm-2","col-form-label"],["type","email","nbInput","","fullWidth","","id","email","placeholder","E-mail","formControlName","email"],["for","perfil",1,"label","col-sm-2","col-form-label"],["fullWidth","","id","perfil","placeholder","Selecione um Perfil","formControlName","perfil",4,"ngIf"],["disabled","","fullWidth","","id","perfil","placeholder","Selecione um Perfil","formControlName","perfil",4,"ngIf"],["formArrayName","turmasDisciplinas","class","form-group row",4,"ngIf"],["class","offset-sm-2 col-sm-10 mb-4",4,"ngIf"],[1,"offset-sm-2","col-sm-10"],["type","submit","nbButton","","status","primary",3,"disabled","click"],["fullWidth","","id","perfil","placeholder","Selecione um Perfil","formControlName","perfil"],["value","Coordenador"],["value","Professor"],["disabled","","fullWidth","","id","perfil","placeholder","Selecione um Perfil","formControlName","perfil"],["formArrayName","turmasDisciplinas",1,"form-group","row"],["for","turma",1,"label","col-sm-2","col-form-label"],["class","col-sm-10",4,"ngIf"],["routerLink","/instituicao/turmas/cadastrar"],["routerLink","/instituicao/disciplinas/cadastrar"],["class","row mb-2",3,"formGroupName",4,"ngFor","ngForOf"],[1,"row","mb-2",3,"formGroupName"],["fullWidth","","id","turma","placeholder","Selecione uma Turma","formControlName","turma",1,"col-sm-6"],[3,"value",4,"ngFor","ngForOf"],["fullWidth","","id","disciplina","placeholder","Selecione uma Disciplina","formControlName","disciplina",1,"col-sm-6"],[1,"col-sm-2"],["type","button","nbButton","","status","primary",3,"click"],["icon","minus-outline"],[3,"value"],[1,"offset-sm-2","col-sm-10","mb-4"],["type","button","nbButton","","status","primary",3,"disabled","click"],["icon","plus-outline"]],template:function(i,e){1&i&&(l.Xb(0,"nb-card",0),l.Xb(1,"nb-card-header"),l.Xb(2,"div",1),l.Xb(3,"div",2),l.Ec(4,v,2,0,"h4",3),l.Ec(5,W,2,0,"h4",3),l.Wb(),l.Wb(),l.Wb(),l.Xb(6,"nb-card-body"),l.Ec(7,B,28,7,"form",4),l.Wb(),l.Wb()),2&i&&(l.nc("nbSpinner",e.isLoading&&!e.form),l.Eb(4),l.nc("ngIf",!e.id),l.Eb(1),l.nc("ngIf",e.id),l.Eb(2),l.nc("ngIf",e.form))},directives:[s.x,s.lb,s.z,g.m,s.w,n.D,n.r,n.i,s.L,n.c,n.q,n.h,o.a,s.s,s.gb,s.bb,n.d,a.f,g.l,n.j,s.I],styles:[""]}),i})();const G=[{path:"",component:b,children:[{path:"",redirectTo:"listar",pathMatch:"full"},{path:"listar",component:h},{path:"adicionar",component:O},{path:"adicionar/:id",component:O}]}];let j=(()=>{class i{}return i.\u0275mod=l.Pb({type:i}),i.\u0275inj=l.Ob({factory:function(e){return new(e||i)},imports:[[a.g.forChild(G)],a.g]}),i})();t.d(e,"ProfessoresModule",(function(){return L}));let L=(()=>{class i{}return i.\u0275mod=l.Pb({type:i}),i.\u0275inj=l.Ob({factory:function(e){return new(e||i)},imports:[[s.A,s.vb,s.K,s.M,s.n,s.D,s.G,s.eb,s.hb,s.xb,c.a,s.t,j,r.c,n.y,o.b,s.mb,s.qb]]}),i})()}}]);